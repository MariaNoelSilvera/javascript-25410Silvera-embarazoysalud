<HEAD>

    <SCRIPT LANGUAGE="JavaScript">

        var datePat = /^(\d{1,2})(\/|-)(\d{1,2})\2(\d{4})$/;


        function dispDate(dateObj) {
            month = dateObj.getMonth() + 1;
            month = (month < 10) ? "0" + month : month; day = dateObj.getDate(); day = (day < 10) ? "0" + day : day;
            year = dateObj.getYear(); if (year < 2000) year += 1900; return (month + "/" + day + "/" + year);
        }
        function pregnancyCalc(pregform) {
            menstrual = new Date();
            ovulation = new Date(); duedate = new Date(); today = new Date(); cycle = 0, luteal = 0;
            menstrualinput = new Date(pregform.menstrual.value);
            menstrual.setTime(menstrualinput.getTime())

            cycle = (pregform.cycle.value == "" ? 28 : pregform.cycle.value);

            if (pregform.cycle.value != "" && (pregform.cycle.value < 22 || pregform.cycle.value > 45)) {
                alert("Your cycle length is either too short or too long for \n"
                    + "calculations to be very accurate! We will still try to \n"
                    + "complete the calculation with the figure you entered. ");
            }

            luteal = (pregform.luteal.value == "" ? 14 : pregform.luteal.value); // defaults to 14

            if (pregform.luteal.value != "" && (pregform.luteal.value < 9 || pregform.luteal.value > 16)) {
                alert("Your luteal phase length is either too short or too long for \n"
                    + "calculations to be very accurate! We will still try to complete \n"
                    + "the calculation with the figure you entered. ");
            }

            // sets ovulation date to menstrual date + cycle days - luteal days
            // the '*86400000' is necessary because date objects track time
            // in milliseconds; 86400000 milliseconds equals one day
            ovulation.setTime(menstrual.getTime() + (cycle * 86400000) - (luteal * 86400000));
            pregform.conception.value = dispDate(ovulation);

            // sets due date to ovulation date plus 266 days
            duedate.setTime(ovulation.getTime() + 266 * 86400000);
            pregform.duedate.value = dispDate(duedate);

            // sets fetal age to 14 + 266 (pregnancy time) - time left
            var fetalage = 14 + 266 - ((duedate - today) / 86400000);
            weeks = parseInt(fetalage / 7); // sets weeks to whole number of weeks
            days = Math.floor(fetalage % 7); // sets days to the whole number remainder

            // fetal age message, automatically includes 's' on week and day if necessary
            fetalage = weeks + " week" + (weeks > 1 ? "s" : "") + ", " + days + " days";
            pregform.fetalage.value = fetalage;

            return false; // form should never submit, returns false
        }

    </script>
</HEAD>



<BODY>

    <center>
        <form onSubmit="return pregnancyCalc(this);">
            <table>
                <tr>
                    <td>
                        <pre>
    Last Menstrual Period:        <input type=text name=menstrual value="" size=10 maxlength=10>
                                  (MM/DD/YYYY format)
    
    Average Length of Cycles:     <input type=text name=cycle value="" size=3 maxlength=3> (22 to 45)
                                  (defaults to 28)
    
    Average Luteal Phase Length:  <input type=text name=luteal value="" size=3 maxlength=3> (9 to 16)
                                  (defaults to 14)
    
    <center><input type=submit value="Calculate!"></center>
    
    Estimated Conception:         <input type=text name=conception value="" size=20>
    Estimated Due Date:           <input type=text name=duedate value="" size=20>
    Estimated Fetal Age:          <input type=text name=fetalage value="" size=20>
    </pre>
                    </td>
                </tr>
            </table>
        </form>
    </center>